<p><meta charset="UTF-8"></p>

<h1>Keeloq for ChipWhisperer</h1>

<p>This is a set of tools to study power analysis of the Keeloq cipher.  It
is based on and integrated with the ChipWhisperer software.</p>

<p>The Keeloq algorithm is very simple, yet omni-present in our current
world, making it an easy target to learn power analysis with.</p>

<p>Tutorials and example traces are provided for quick entry, even without
having to buy any specialized hardware.</p>

<p>Implementation and documentation copyright 2016 by Marc.</p>

<hr />

<h2>Toolset overview</h2>

<h3>Keeloq data capture</h3>

<p>Loose collection of utilities to capture Keeloq data transmissions and
annotate them to power traces.</p>

<ul>
<li>GNURadio flow to receive and demodulate RF messages</li>
<li>Keeloq OOK decoder to convert baseband to HEX values</li>
<li><a href="../hex_to_npy/hex_to_npy.py">Script to annotate HEX values</a> to traces captured with ChipWhisperer</li>
</ul>

<h3>Preprocessing filter: Resync Slice-to-Slot</h3>

<p>Powerful plugin to prepare traces for analysis.</p>

<ul>
<li>Compensate for RC oscillator clock drift</li>
<li>Extract arbitrary point ranges from each round</li>
<li>Compress rounds to single point values</li>
<li>Visually separate rounds with zero-padding</li>
</ul>

<h3>Trace Explorer partition modes: Keeloq (various)</h3>

<p>Several partition modes relevant to the Keeloq algorithm.  Useful for visual
exploration, understanding the attacks, and even executing them manually.</p>

<ul>
<li><strong>Bit (various)</strong>: Partition by ciphertext output or intermediate
                   LSB/MSB value</li>
<li><strong>HD (various)</strong>:  Partition by Hamming distance of status register
                   during shift operations</li>
</ul>

<h3>Attack module: Keeloq DPA</h3>

<p>Container for several automatted attacks:</p>

<ul>
<li><strong>Encoder Bit model</strong>: Attacks the intermediate MSB bit value.</li>
<li><strong>Encoder HD model</strong>:  Attacks the status register Hamming distance
                       during shift operations.</li>
</ul>

<hr />

<h2>Tutorial overview</h2>

<h3><a href="keeloq_algorithm/keeloq_algorithm.html">The Keeloq algorithm</a></h3>

<p>Rehash of public information about Keeloq.</p>

<ul>
<li>Algorithm description</li>
<li>Implementations</li>
<li>Crypto analysis</li>
<li>Source code</li>
</ul>

<h3>Capture power consumption of HCS301</h3>

<blockquote>
  <p><strong>### TODO ###</strong>: Not finished yet</p>
</blockquote>

<ul>
<li>Prepare victim (GND shunt)</li>
<li>Connect CW1002 and differential probe</li>
<li>Configure CW Capture software</li>
<li>Find suitable triggers</li>
</ul>

<h3>Capture ciphertext of HCS301 with GNU Radio</h3>

<blockquote>
  <p><strong>### TODO ###</strong>: Not finished yet</p>
</blockquote>

<ul>
<li>Configure GNU Radio live-boot environment</li>
<li>Prepare reception of RF messages</li>
<li>Perform capture of power and RF data simultaneously</li>
<li>Annotate ciphertext data to power traces</li>
</ul>

<h3>Preparation of traces</h3>

<blockquote>
  <p><strong>### TODO ###</strong>: Not finished yet</p>
</blockquote>

<ul>
<li>Compensate for clock drift and eliminate freaks</li>
<li>Recover round timing</li>
<li>Identify and extract interesting point ranges</li>
<li>Compress to peaks</li>
<li>Export polished results</li>
</ul>

<h3><a href="attack_bits/attack_bits.html">Bit model attack on Keeloq</a></h3>

<p>Explains the bit model attack script and partition modes.</p>

<ul>
<li>Find leakage with <em>Trace Explorer</em></li>
<li>Recover round timing</li>
<li>Manual key recovery</li>
<li>Interpret unexpected results</li>
<li>Automatic key recovery</li>
</ul>

<h3>Hamming distance model attack on Keeloq</h3>

<blockquote>
  <p><strong>### TODO ###</strong>: Not finished yet</p>
</blockquote>

<hr />

<h2>Example traces</h2>

<p>The traces are provided to complement the tutorials, and to serve as
starting point for further studies.</p>

<ul>
<li><a href="examples_hcs301/examples_hcs301.html">HCS301 encoder chip</a></li>
</ul>

<hr />

<p><em>Document author: marc</em> -
<em>Document version: 22-Oct-2016</em> -
<a href="../readme.html">Fork README</a></p>
